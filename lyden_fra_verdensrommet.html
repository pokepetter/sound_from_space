<html><title>Lyden fra verdensrommet</title><body>
<script src="taptapir.js"></script>
<script type='text/sunsnake'>

set_orientation('horizontal')
set_background_color('#000')
set_window_color('#111')
load_font('Orbitron-Black')

SCENE_INDEX = -1
title_screen = Scene(name='title_screen', texture='lyden_fra_verdensrommet_banner.png', z=-2)
frame = Entity(texture='frame.png', z=-20, scale_x=16/9*1.02, scale_y=1.02)


oxygen_meter = HealthBar(position=[.75, .3, -1], rotation=-90, scale_x=.2, scale_y=.03, text_color=color.clear, alpha=.1, bar_color='#c6edf5ee')
_ = Button(parent=oxygen_meter, font='Orbitron-Black', text='Konsetrasjon \nper m3 i kabinen\n|\n|\n_', text_origin=[-.5,.5], x=-.45, y=1.2, z=-10, text_color=color.white, color=hsv(0,0,1,.0), text_size=.5, enabled=1, t=0)

gravity_meter = HealthBar(position=[.75+.05, .3, -1], rotation=-90, scale_x=.2, scale_y=.03, text_color=color.clear, alpha=.1, bar_color='#c6edf5ee')

# oxygen_meter.bar.alpha=.75
# oxygen_meter.value = 80


launch_scene = Scene(name='launch_scene', texture='stars_small.png')
sun_far = Entity(parent=launch_scene, texture='stars.png', scale=16/9)
# launch_scene.on_enable = def _():
door_bot = Entity(parent=launch_scene, texture='airlock_door_bottom.png', origin=[0,.5], scale_x=16/9, scale_y=.5, z=-20)
door_top = Entity(parent=launch_scene, texture='airlock_door_top.png', origin=[0,-.5], scale_x=16/9, scale_y=.5, z=-20)
launch_scene.on_enable = def():
    door_top.y = 0
    door_bot.y = 0
    sun_far.y = .5

launch_scene.input = def input(key):
    if key == 'space':
        door_top.animate('y', .5, duration=15, curve=curves.linear)
        door_bot.animate('y', -.5, duration=15, curve=curves.linear)
        camera.shake(duration=3)
        sun_far.animate('y', 0, duration=30)

# Button(parent=launch_scene, font='Orbitron-Black', text='Oppskytning om\n3...\n2...\n1...', z=-10, text_color=color.light_gray, color=color.clear)
                     

# space_scene = Scene(name='space_scene')
# space_scene.bg = Entity(parent=space_scene, texture='stars.png', scale_x=16/9, texture_offset=[0,0])

# space_scene.update = def():
#     space_scene.bg.texture_offset = [space_scene.bg.texture_offset[0]-.00005, space_scene.bg.texture_offset[1]-.00005]


# sun_far_scene = Scene(name='sun_far_scene', texture='stars.png')
# Button(parent=sun_far_scene, font='Orbitron-Black', text='(solen langt vekke)', text_size=2, z=-10, text_color=color.light_gray, color=color.clear)

sun_scene = Scene(name='sun_scene', texture='stars.png')
sun = Entity(parent=sun_scene, texture='sun_bloom.gif', scale=16/9)
waveform = Entity(parent=sun_scene, texture='waveform_2.gif', scale=[.5,.25], roundness=.1, z=-1, y=.35, x=-.5)

sun_scene.on_enable = def():
    print('goto sun')
    sun.y = .39
    sun.animate('y', -.1, duration=60, curve=curves.out_expo)
    # show_info(title='Sol', description='', character_duration=.2)

asteroid_scene = Scene(name='asteroid_scene', texture='stars_small.png')
asteroid_bg = Entity(parent=asteroid_scene, texture='asteroid_field_bg.png', scale_x=16/9, scale_y=1, texture_offset=[0,0])
asteroid_mg = Entity(parent=asteroid_scene, texture='asteroid_field_mg.png', scale_x=16/9*1.2, scale_y=1.2, texture_offset=[0,0])
asteroid_fg_2 = Entity(parent=asteroid_scene, texture='asteroid_field_fg.png', scale_x=16/9*1.2, scale_y=1.2, texture_offset=[0,0])
asteroid_fg = Entity(parent=asteroid_scene, texture='asteroid_field_fg_2.png', scale_x=16/9*1.2, scale_y=1.2,  texture_offset=[0,0])
asteroid_0 = Entity(parent=asteroid_scene, texture='asteroid_0.png', scale=0)
asteroid_scene.update = def():
    asteroid_bg.texture_offset = [asteroid_bg.texture_offset[0]-.0001*-2, asteroid_bg.texture_offset[1]-.00007*-2]
    asteroid_mg.texture_offset = [asteroid_mg.texture_offset[0]-(.0001*5), asteroid_mg.texture_offset[1]-(.00007*5)]
    asteroid_fg.texture_offset = [asteroid_fg.texture_offset[0]-(.0001*24), asteroid_fg.texture_offset[1]-(.00007*24)]
    asteroid_fg_2.texture_offset = [asteroid_fg_2.texture_offset[0]-(.0001*18), asteroid_fg_2.texture_offset[1]-(.00007*18)]
    # asteroid_scene.rotation += 3
# set_scale(.95)
asteroid_scene.on_enable = def():
    waveform.enabled = False
    show_info(title='Asteroidebeltet', description='Sted: Mellom Mars og Jupiter\nAvstand fra Solen: 2 - 3.3 AU\nAntall: 1-2 millioner > ⌀1km\n Dvergplaneter: Ceres', character_duration=.05)

    # hyperjump.enabled = False
asteroid_direction = -1
asteroid_scene.input = def input(key):
    if key == 'space':
        asteroid_0.scale = [.4,.4]
        asteroid_0.xy = [.6*16/9,.6]
        asteroid_0.animate('scale_x', 5, duration=5, curve=curves.out_expo)
        asteroid_0.animate('scale_y', 5, duration=5, curve=curves.out_expo)
        # asteroid_0.animate('rotation', 80, duration=2)

        after 1:
            asteroid_0.animate('x', -3*asteroid_direction, duration=2, curve=curves.out_expo)
            asteroid_0.animate('y', -.4*asteroid_direction, duration=2)
        
            asteroid_bg.animate('x', -.1*asteroid_direction, duration=2)
            asteroid_mg.animate('x', -.2*asteroid_direction, duration=2)
            asteroid_fg.animate('x', -.3*asteroid_direction, duration=2)
        
            after 2:
                asteroid_bg.animate('x', 0, duration=2)
                asteroid_mg.animate('x', 0, duration=2)
                asteroid_fg.animate('x', 0, duration=2)
        if asteroid_direction == 1:
            asteroid_direction = -1
        else:
            asteroid_direction = 1
        # after 2s:
        # after .2s:
        # asteroid_belt.animate('rotation', -30, duration=7, loop=True)
        # after 7:
        #     asteroid_belt.animate('rotation', 30, duration=7, loop=True)

# asteroid_avoidance_game =

europa_scene = Scene(name='europa_scene', texture='stars_small.png')
europa = Entity(parent=europa_scene, texture='europa.png')
europa_scene.on_enable = def():
    europa.scale_x = 16/9 * 1
    europa.scale_y = 1
    europa.xy = [0,0]
    
    print('europa')
    europa.y = -.15
    duration= 30
    europa.animate('y', 0, duration=duration)
    # europa.animate('scale_x', 16/9, duration=duration)
    # europa.animate('scale_y', 1, duration=duration)
    show_info(title='Europa', description='Gjennomsnittsfart\n13,74 km/s\nInklinasjon	0,47°\nModerplanet	Jupiter', character_duration=.05)
    
europa_scene.white_cover = Entity(parent=europa_scene, scale=3, alpha=0, z=-12)
# emergency_landing_prompt = Button(parent=europa_scene, font='Orbitron-Black', text='Starter nødlanding', z=-10, text_color=color.light_gray, color=color.clear)

europa_scene.input = def input(key):
    if key == 'space':
        europa.y = -.15
        reset_text()
        # europa.animate('y', -.02, duration=1)
        after 1s:
            # europa.animate('rotation', 30, duration=10)
            # europa.animate('y', -.35, duration=2)
            europa.animate('scale_y', 1.5, duration=5, curve=curves.in_expo)
            europa.animate('scale_x', 16/9*1.5, duration=5, curve=curves.in_expo)
            # camera.shake(duration=3)
            show_warning('Starter nødlanding...')
            after 2s:
                europa_scene.white_cover.animate('alpha', 1, duration=2, curve=curves.in_expo)
                after 4s:
                    travel_to(SCENE_INDEX+1)
                    europa_scene.white_cover.animate('alpha', 0, duration=3)

    # b = Button(parent=europa_scene, text='EUROPA', z=-10, text_color=color.light_gray, color=color.clear)

underwater_scene = Scene(name='underwater_scene', texture='underwater_2.png')
underwater_graphics = Entity(parent=underwater_scene, texture='underwater_2.png', scale_x=16/9, texture_offset=[0,0])
underwater_cover = Entity(parent=underwater_scene, scale=2, color=color.black, z=-2)
ice_effect = Entity(parent=underwater_scene, scale_x=16/9, texture='freeze_effect.png', z=-1, alpha=.5)
underwater_scene.on_enable = def():
    underwater_graphics.y = -.1
    underwater_graphics.animate('y', 0, duration=30, curve=curves.out_expo)
    underwater_cover.alpha = 1
    underwater_cover.animate('alpha', 0, duration=10)
    ice_effect.alpha = 0
    after 2:
        ice_effect.animate('alpha', .75, duration=10)
    # show_info(title='Europa', description='Alder ???år\nAntall planeter ???\nStjerner ???\nLiv ???\nOrbital hastighet 720 000 km/t\nOmløpsperiode ~230 millioner år', character_duration=.05)
underwater_scene.input = def input(key):
    if key == 'space':
        show_hyperjump_warning()
        # hyperjump_to(SCENE_INDEX+1)



warning = Button(font='Orbitron-Black', text='⚠️ Advarsel ⚠️\nLav gravitasjon', z=-2, text_color=color.white, color=hsv(0,.9,.8,.5), padding=[1,1], roundness=.02, enabled=False, t=0)
warning.update = def _():
    warning.t += 1/60 * 8
    warning.alpha = .5 + (math.sin(warning.t) * .25)
        
def show_warning(text, box_color=hsv(0,.9,.8,.5)):
    warning.t = 0
    warning.enabled = True
    warning.color = box_color
    warning.text = text
    warning.fit_to_text()
    target_scale_x = warning.scale_x
    warning.scale_x = .05
    warning.animate('scale_x', target_scale_x, duration=1)

def stop_warning():
    warning.animate('alpha', 0, duration=.25)
    warning.enabled = False
    # stop_warning_routine = invoke(warning.disable, delay=.5)

def show_hyperjump_warning():
    print('show hyperjump warning')
    show_warning('Starter hyperhopp...', color.azure)

gravity_scene = Scene(name='gravity_scene', i=0)
gravity_scene.stars = Entity(parent=gravity_scene, texture='stars.png', scale_x=16/9, texture_offset=[0,0])
gravity_scene.on_enable = def():
    hyperjump.enabled = True

gravity_scene.input = def input(key):
    if key == 'space':
        print('--', gravity_scene.i)
        if gravity_scene.i == 0:
            gravity_meter.value = 20
        if gravity_scene.i == 1:
            show_warning('⚠️ Advarsel ⚠️\nLav gravitasjon')
        if gravity_scene.i == 2:
            stop_warning()
        gravity_scene.i += 1
        camera.shake()


gravity_scene.update = def():
    gravity_scene.stars.texture_offset = [gravity_scene.stars.texture_offset[0]-.00005, gravity_scene.stars.texture_offset[1]-.00005]
        

mixolydia_centauri_scene = Scene(name='mixolydia_centauri_scene', texture='stars.png')
# Entity(parent=mixolydia_centauri_scene, scale=.2, text='mixolydia_centauri').fit_to_text()
# mixolydia_bg = Entity(parent=mixolydia_centauri_scene, texture='stars.png', scale_x=16/9, z=1)
mixolydia = Entity(parent=mixolydia_centauri_scene, texture='mixolydia_centauri.png', scale_x=16/9, z=-1)
mixolydia_centauri_scene.on_enable = def():

    print('GO TO:', mixolydia_centauri_scene)
    mixolydia.y = .3
    hyperjump.enabled = True
    after hyperjump_duration:
        mixolydia.animate('y', .1, duration=20)
        after 5:
            show_info(title='Mixolydia\nCentauri', description='Alder ???år\nAntall planeter ???\nStjerner ???\nLiv ???\nOrbital hastighet 720 000 km/t\nOmløpsperiode ~230 millioner år', character_duration=.05)

#  nterference/white noise
alien_scene = Scene(name='alien', texture='mixolydia_centauri.png')
incoming_transmission = Button(parent=alien_scene, font='Orbitron-Black', text='Incoming Transmission', z=-10, text_color=color.light_gray, color=color.clear)
incoming_transmission.fit_to_text()

# Entity(parent=alien_scene, scale=.2, text='alien_scene').fit_to_text()
video_transmission = Entity(parent=alien_scene, scale=[16/9*.4, .4], texture='scary_alien.gif', roundness=.1)

alien_scene.on_enable = def():
    incoming_transmission.enabled = False
    after
    video_transmission.enabled = False
    after 3s:
        video_transmission.scale_y = 0
        video_transmission.enabled = True 
        video_transmission.animate('scale_y', .4, duration=.5)


central_star_explosion_scene = Scene(name='central_star_explosion', texture='mixolydia_centauri.png')
Entity(parent=central_star_explosion_scene, scale=.2, text='eksplosjon', color=color.clear, text_color=color.gray).fit_to_text()

mixolydia_centauri_with_moons_scene = Scene(name='mixolydia_centauri', texture='mixolydia_centauri')
# Entity(parent=mixolydia_centauri_with_moons_scene, scale=.2, text='MIXOLYDIA CENTAURI\n+ moons', color=color.clear, text_color=color.gray).fit_to_text()


pale_blue_dot_scene = Scene(name='pale_blue_dot')
pale_blue_dot = Entity(parent=pale_blue_dot_scene, texture='pale_blue_dot.jpg', scale=[3/2*2, 2])
pale_blue_dot_scene.on_enable = def():
    pale_blue_dot.xy = [.3,.2]
    pale_blue_dot.animate('x', 0, duration=20)
    pale_blue_dot.animate('y', 0, duration=20)



terra_scene = Scene(name='terra', texture='stars.png')
terra = Entity(parent=terra_scene, texture='terra.png', scale_x=16/9)
terra.door_bot = Entity(parent=terra_scene, texture='airlock_door_bottom.png', origin=[0,.5], scale_x=16/9, scale_y=.5, z=-20)
terra.door_top = Entity(parent=terra_scene, texture='airlock_door_top.png', origin=[0,-.5], scale_x=16/9, scale_y=.5, z=-20)
# naso_logo = Entity(parent=terra_scene, texture='NASO_transparent.png', scale_x=3599/2312*.5, scale_y=.5)

terra_scene.on_enable = def():
    hyperjump.enabled = True
    # naso_logo.alpha = 0
    terra.y = -.5
    terra.door_top.y = .5
    terra.door_bot.y = -.5
    after 6s:
        terra.animate('y', 0, duration=50)

terra_scene.input = def input(key):
    if key == 'space':
        terra.door_top.animate('y', 0, duration=1)
        terra.door_bot.animate('y', 0, duration=1)


# hyperjump_scene = Scene(name='hyperjump', texture='')
hyperjump_duration = 3
# hyperjump = Entity(enabled=False, texture='hyperjump_v2.gif', scale_x=16/9)
hyperjump = Entity(visible_self=False)
hyperjump.video = Video(name='hyperjump_frames/output_video.mp4', scale=2, parent=hyperjump)
hyperjump.white_cover = Entity(parent=hyperjump.video)

hyperjump.on_enable = def():
    print('hyperjump!')
    hyperjump.white_cover.alpha = 0
    hyperjump.video.stop()
    oxygen_meter.enabled = False
    gravity_meter.enabled = False
    IS_IN_HYPERJUMP = True
    # after 3s:
    stop_warning()
    hyperjump.video.alpha = 1
    hyperjump.video.play()
    after hyperjump_duration:
        print('hyperjump done, fading')
        hyperjump.video.alpha = 0
        hyperjump.white_cover.alpha = 1
        hyperjump.white_cover.animate('alpha', 0, duration=5)
        IS_IN_HYPERJUMP = False


text_parent = Entity(parent=camera.ui, x=-(16/9*.5)+.1, y=.3, visible_self=False, scale=1)
title_text = Button(parent=text_parent, font='Orbitron-Black', text='Terra', text_origin=[-.5,-.5], origin=[-.5,.5], text_size=8*.5, text_color='#c6edf5ee', color=color.clear, scale_x=1)
title_text.model.style.textDecoration = 'underline'

description_text = Button(parent=text_parent, font='Orbitron-Black', text_origin=[-.5,.5], text_size=2*.5, text='6 000 000 000km', text_color='#c6edf5ee', color=color.clear, x=title_text.x, y=title_text.y-.2, origin=[-.5,.5], scale_x=.6, scale_y=.7)
title_text.text = ''
description_text.text = ''

reset_text_routine = None
def show_info(title='', description='', character_duration=.05, duration=4):
    title = title.split('')
    description = description.split('')
    if reset_text_routine:
        stop_invoke(reset_text_routine)
        reset_text_routine = None

    title_text.text = ''
    description_text.text = ''
    title_text.alpha = 1
    description_text.alpha = 1

    for i, e in title:
        after i*character_duration:
            title_text.text += e
    for i, e in description:
        after i*character_duration:
            description_text.text += e
        
    total_duration = max(len(title)*character_duration, len(description)*character_duration) + duration
    # print('------|||||||||||', total_duration)
    reset_text_routine = invoke(reset_text, delay=total_duration)

def reset_text(hard=False):
    if hard:
        title_text.alpha = 0
        description_text.alpha = 0
        return

    title_text.animate('alpha', 0, duration=1)
    description_text.animate('alpha', 0, duration=1)
    # let _title = title_text.text.split('')
    # let _description = description_text.text.split('')
    # for _j in range(len(_title)):
    #     after _j*.025:
    #         # print(i)
    #         _title[len(_title) - _j] = ' '
    #         # print(_title)
    #         title_text.text = _title.join('')
    after .25s:
        title_text.text = ''
        description_text.text = ''

    # random_choice(_title)
    # print('--------------')
    # print('random_indices:', title)
    # for i, random_idx in enumerate(random_indices):
    #     after i*.1:
    #         _title[random_idx] = ' '
    #         print(_title)
    #         title_text.text = _title.join('')
    # print('-------', temp)
    


goto_scene(title_screen)

scenes = [
title_screen,
launch_scene,
launch_scene,
sun_scene, 
asteroid_scene, 
asteroid_scene, 
asteroid_scene, 
asteroid_scene, 
europa_scene, 
europa_scene,
underwater_scene,
underwater_scene,
gravity_scene, 
gravity_scene, 
gravity_scene, 
mixolydia_centauri_scene,
alien_scene,
central_star_explosion_scene,
mixolydia_centauri_with_moons_scene,
pale_blue_dot_scene, 
terra_scene, 
terra_scene, 
title_screen,
]

def travel_to(index):
    print('goto next scene:', index, scenes[index].name)
    if index != SCENE_INDEX:
        stop_all_invokes()
        stop_warning()
    index = clamp(index, 0, len(scenes)-1)
    hyperjump.enabled = False
    reset_text(hard=True)
    goto_scene(scenes[index])
    gravity_meter.enabled = True
    oxygen_meter.enabled = True
    # if hyperjump.white_cover.alpha > 0:
    #     print('dafe out hyperjup white cover')
    #     hyperjump.white_cover.animate('alpha', 0, duration=5)

IS_IN_HYPERJUMP = False


def stop_hyperjump():
    hyperjump.video.alpha = 0
    hyperjump.white_cover.alpha = 1
    hyperjump.white_cover.animate('alpha', 0, duration=5)

# NASO-logo.
def input(key):
    # print(key)
    number_keys = '0123456789!"#¤%&/()'.split('')
    if key in number_keys:
        SCENE_INDEX = clamp(number_keys.index(key), 0, len(scenes)-1)
        stop_all_invokes()
        travel_to(SCENE_INDEX)

    if key == 'space' or key == 'right arrow' and not IS_IN_HYPERJUMP:
        SCENE_INDEX += 1
        SCENE_INDEX = clamp(SCENE_INDEX, 0, len(scenes)-1)
        travel_to(SCENE_INDEX)

    elif key == 'left arrow':
        SCENE_INDEX -= 1
        SCENE_INDEX = clamp(SCENE_INDEX, 0, len(scenes)-1)
        travel_to(SCENE_INDEX)

    elif IS_IN_HYPERJUMP and key == 'escape':
        stop_hyperjump()


print('a')
</script>
<script src="sunsnake_compiler.js"></script>
